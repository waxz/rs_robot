

# 原则
限定场景的问题 的 限定解法
不能解决所有问题，但是所有问题都要有确定的终点，有解或者无解
在逻辑流程如何发生
在代码流程如何实现


# 目标
### 安全，精度，平滑
A 在容差范围内尽量减小旋转
B 在可以旋转的地方，如果角度差异过大，可以旋转
C 速度平滑


如何确保一定能走到
特别是舵轮边旋转边行走的时候



### 极限情况
A 当车体和控制点几乎在最终的直线上时，偏差一个正一个负
B 当小车


# TODO:

### 速度平滑
### 路径突变点，舵轮角度响应不及时会导致偏差超出范围，应该根据速度分量减小速度

# 问题点

1. 跟踪点在路径分割点处会突变，突变的动作指令在响应不及时的情况下，小车会冲过头
    - 减小速度
    - 避免跟踪点突变
    - 冲过头时应该检测并报错

2. 初始控制点偏差过大时，跟踪点将选择最近点
3. 开始时，选择的跟踪点不是角度最小的点



# 控制风险
### 初始偏差
启动时，初始位置有偏差，根据第一段路径类型和任务类型选择不同的收敛方法。
A 当叉车需要笔直退出工位，因禁止旋转，直到撤出限制空间。
B 当路径是直线段后续是弧线段，先摆正到直线上的动作就是多余的。
B 当路径是弧线段，先摆正到弧线上的动作就是多余的。




1. 任务类型，指定是否需要笔直退出，退出距离
2. 如果当前路径是直线，那么将沿着直线方向行走，
3. 如果当前路径是曲线或者直线段长度不够长，报错。 报错在处理路径的阶段。











# NOTE:















1.motion planner 接收请求的路径，分析路径特性， 拒绝不合理的任务。
2. 开始运动控制时候，机器人方向可能跟路径需求不一样，位置也可能偏离。    




# 对路径的要求
- 平滑，拐弯使用圆弧
- 行走方向一致，同一条路径的行走方向只能是`前进`或者`后退`两者之一。
- 终点避免原地旋转，有需要的话使用单独的旋转指令？
- 长距离，非全乡车型跟随路径需要较长的距离才能收敛
- 路径数组中的节点坐标不要重复，保持固定的距离





3. 定位跳动导致提前停车



曲线稳定
路径容许宽度 增大
控制点control_point 减小
跟踪点target_point 增大
都可以用来缩小因为定位波动导致的驱动轮角度波动

终点段是直线，可配置是否有旋转限制。
终点段是弧线，一定没有旋转限制。

运动限制下不能满足x，y，yaw 的全部约束，通过放大y的限制来避免旋转，保证x，yaw的约束